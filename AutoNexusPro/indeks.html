<!DOCTYPE html>
<html lang="tr" class="antialiased">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AutoNexus Pro | Global Automotive Intelligence Platform</title>
    
    <!-- Core Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">

    <!-- Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'], mono: ['JetBrains Mono', 'monospace'] },
                    colors: { 
                        brand: { 500: '#3b82f6', 600: '#2563eb' }, 
                        slate: { 850: '#1e293b', 900: '#0f172a', 950: '#020617' } // Lighter darks
                    },
                    animation: { 'fade-in': 'fadeIn 0.5s ease-out' },
                    keyframes: { fadeIn: { '0%': { opacity: '0', transform: 'translateY(10px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } } }
                }
            }
        }
    </script>

    <style>
        /* Modern Corporate Palette - Not Pitch Black */
        body { background-color: #0f172a; color: #f1f5f9; overflow: hidden; }
        
        /* Glassmorphism Panels - Lighter & Cleaner */
        .glass-panel {
            background: rgba(30, 41, 59, 0.7); /* Lighter slate */
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 4px 20px -1px rgba(0, 0, 0, 0.2);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .glass-panel:hover { border-color: rgba(59, 130, 246, 0.4); transform: translateY(-2px); }

        /* Custom Scrollbar */
        .custom-scroll::-webkit-scrollbar { width: 6px; height: 6px; }
        .custom-scroll::-webkit-scrollbar-track { background: transparent; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #475569; border-radius: 3px; }
        .custom-scroll::-webkit-scrollbar-thumb:hover { background: #64748b; }

        /* Navigation Active State */
        .nav-item { border-left: 3px solid transparent; }
        .nav-item.active { 
            background: linear-gradient(90deg, rgba(59, 130, 246, 0.1), transparent); 
            border-left-color: #3b82f6; 
            color: white; 
            font-weight: 600;
        }
        .nav-item i { transition: color 0.3s; }
        .nav-item.active i { color: #60a5fa; }
    </style>
</head>
<body class="flex h-screen w-full selection:bg-blue-500 selection:text-white">

    <!-- 1. SIDEBAR -->
    <aside class="w-64 h-full bg-[#0f172a] border-r border-slate-700/50 flex flex-col z-50 flex-shrink-0 shadow-xl">
        <!-- Logo -->
        <div class="h-20 flex items-center px-6 border-b border-slate-700/50">
            <div class="w-9 h-9 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-xl flex items-center justify-center text-white mr-3 shadow-lg shadow-blue-500/20">
                <i class="ph-bold ph-hexagon text-xl"></i>
            </div>
            <div>
                <h1 class="font-bold text-lg tracking-tight text-white leading-none">AutoNexus</h1>
                <p class="text-[10px] text-blue-400 font-medium tracking-widest uppercase mt-0.5 opacity-80">Titanium v8.0</p>
            </div>
        </div>

        <!-- Menu -->
        <nav class="flex-1 overflow-y-auto custom-scroll py-6 space-y-0.5">
            <div class="px-6 mb-3 text-[10px] font-bold text-slate-400 uppercase tracking-wider">Analiz Merkezi</div>
            
            <button onclick="router('dashboard')" id="nav-dashboard" class="nav-item active w-full flex items-center px-6 py-3 text-sm text-slate-400 hover:bg-slate-800/50 hover:text-slate-200 transition">
                <i class="ph ph-squares-four text-lg mr-3"></i> Kokpit
            </button>
            <button onclick="router('market')" id="nav-market" class="nav-item w-full flex items-center px-6 py-3 text-sm text-slate-400 hover:bg-slate-800/50 hover:text-slate-200 transition">
                <i class="ph ph-grid-four text-lg mr-3"></i> Market Matrisi
            </button>
            <button onclick="router('ai')" id="nav-ai" class="nav-item w-full flex items-center px-6 py-3 text-sm text-slate-400 hover:bg-slate-800/50 hover:text-slate-200 transition group">
                <i class="ph ph-sparkle text-lg mr-3 text-purple-400 group-hover:text-purple-300"></i> Nexus AI
            </button>

            <div class="px-6 mt-6 mb-3 text-[10px] font-bold text-slate-400 uppercase tracking-wider">MÃ¼hendislik & Finans</div>
            
            <button onclick="router('lab')" id="nav-lab" class="nav-item w-full flex items-center px-6 py-3 text-sm text-slate-400 hover:bg-slate-800/50 hover:text-slate-200 transition">
                <i class="ph ph-flask text-lg mr-3"></i> MÃ¼h. LaboratuvarÄ±
            </button>
            <button onclick="router('compare')" id="nav-compare" class="nav-item w-full flex items-center px-6 py-3 text-sm text-slate-400 hover:bg-slate-800/50 hover:text-slate-200 transition">
                <i class="ph ph-scales text-lg mr-3"></i> KÄ±yaslama Motoru
                <span id="compare-badge" class="ml-auto bg-blue-600 text-white text-[9px] font-bold px-1.5 py-0.5 rounded hidden">0</span>
            </button>
            <button onclick="router('finance')" id="nav-finance" class="nav-item w-full flex items-center px-6 py-3 text-sm text-slate-400 hover:bg-slate-800/50 hover:text-slate-200 transition">
                <i class="ph ph-currency-dollar text-lg mr-3"></i> Finans Merkezi
            </button>
             <button onclick="router('trends')" id="nav-trends" class="nav-item w-full flex items-center px-6 py-3 text-sm text-slate-400 hover:bg-slate-800/50 hover:text-slate-200 transition">
                <i class="ph ph-chart-line-up text-lg mr-3"></i> Trend Analizi
            </button>

            <div class="px-6 mt-6 mb-3 text-[10px] font-bold text-slate-400 uppercase tracking-wider">KiÅŸisel</div>
            
            <button onclick="router('garage')" id="nav-garage" class="nav-item w-full flex items-center px-6 py-3 text-sm text-slate-400 hover:bg-slate-800/50 hover:text-slate-200 transition">
                <i class="ph ph-garage text-lg mr-3"></i> Sanal Garaj
                <span id="garage-badge" class="ml-auto bg-emerald-600 text-white text-[9px] font-bold px-1.5 py-0.5 rounded hidden">0</span>
            </button>
            <button onclick="router('reports')" id="nav-reports" class="nav-item w-full flex items-center px-6 py-3 text-sm text-slate-400 hover:bg-slate-800/50 hover:text-slate-200 transition">
                <i class="ph ph-file-pdf text-lg mr-3"></i> Raporlar
            </button>
        </nav>

        <!-- Profile -->
        <div class="p-4 border-t border-slate-700/50 bg-slate-900/50">
            <div class="flex items-center gap-3 p-2.5 rounded-xl hover:bg-slate-800 transition cursor-pointer group">
                <div class="w-9 h-9 rounded-lg bg-gradient-to-tr from-emerald-500 to-teal-600 flex items-center justify-center text-xs font-bold text-white shadow-sm group-hover:scale-105 transition">CB</div>
                <div class="flex-1 min-w-0">
                    <p class="text-xs font-bold text-white truncate">Ceyhun BostancÄ±</p>
                    <p class="text-[10px] text-slate-400 truncate">Kalite YÃ¶neticisi</p>
                </div>
                <i class="ph-fill ph-gear text-slate-500 group-hover:text-white transition"></i>
            </div>
        </div>
    </aside>

    <!-- 2. MAIN AREA -->
    <main class="flex-1 flex flex-col min-w-0 bg-[#1e293b] relative">
        
        <!-- Header -->
        <header class="h-20 border-b border-slate-700/50 flex items-center justify-between px-8 bg-[#1e293b]/90 backdrop-blur z-40 sticky top-0 shadow-sm">
            <div>
                <h2 id="page-title" class="text-xl font-bold text-white tracking-tight">Analiz Kokpiti</h2>
                <div class="flex items-center gap-2 text-xs text-slate-400 mt-1">
                    <span class="flex h-2 w-2 relative">
                        <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span>
                        <span class="relative inline-flex rounded-full h-2 w-2 bg-emerald-500"></span>
                    </span>
                    Sistem Aktif â€¢ <span id="current-date"></span>
                </div>
            </div>

            <div class="flex items-center gap-4">
                <!-- Currency Toggle -->
                <div class="flex bg-slate-800 rounded-lg p-1 border border-slate-700">
                    <button onclick="setCurrency('TRY')" id="curr-TRY" class="px-3 py-1 rounded-md text-xs font-bold bg-blue-600 text-white shadow transition">TRY</button>
                    <button onclick="setCurrency('USD')" id="curr-USD" class="px-3 py-1 rounded-md text-xs font-bold text-slate-400 hover:text-white transition">USD</button>
                    <button onclick="setCurrency('EUR')" id="curr-EUR" class="px-3 py-1 rounded-md text-xs font-bold text-slate-400 hover:text-white transition">EUR</button>
                </div>

                <div class="h-8 w-px bg-slate-700 mx-2"></div>

                <button class="relative p-2 text-slate-400 hover:text-white transition hover:bg-slate-800 rounded-full">
                    <i class="ph ph-bell text-xl"></i>
                    <span class="absolute top-2 right-2 w-2 h-2 bg-red-500 rounded-full border-2 border-[#1e293b]"></span>
                </button>
            </div>
        </header>

        <!-- Content Area -->
        <div id="content-area" class="flex-1 overflow-y-auto custom-scroll p-8 relative bg-gradient-to-br from-[#1e293b] to-[#0f172a]">
            <!-- Dynamic Injection -->
        </div>

    </main>

    <!-- 3. DEEP DIVE MODAL -->
    <dialog id="car-modal" class="backdrop:bg-black/80 bg-transparent w-full h-full max-w-6xl max-h-[90vh] p-0 rounded-2xl shadow-2xl overflow-hidden m-auto border border-slate-600/50">
        <div class="h-full flex flex-col bg-[#0f172a] text-white">
            <!-- Modal Header -->
            <div class="h-16 border-b border-slate-700 flex items-center justify-between px-6 bg-[#1e293b]">
                <div class="flex items-center gap-3">
                    <span id="m-badge" class="px-2 py-0.5 rounded text-[10px] font-bold bg-blue-500/10 text-blue-400 border border-blue-500/20 tracking-wider">PREMIUM</span>
                    <h3 id="m-title" class="text-lg font-bold">Model AdÄ±</h3>
                </div>
                <div class="flex items-center gap-3">
                    <button onclick="toggleGarage(currentModalCarId)" class="px-3 py-1.5 rounded-lg bg-emerald-600/20 text-emerald-400 hover:bg-emerald-600/30 text-xs font-bold flex items-center gap-2 transition border border-emerald-600/20">
                        <i class="ph-bold ph-garage"></i> <span id="m-garage-btn">Garaja Ekle</span>
                    </button>
                    <button onclick="closeModal()" class="w-8 h-8 rounded-full bg-slate-700 hover:bg-slate-600 flex items-center justify-center transition text-slate-300 hover:text-white"><i class="ph-bold ph-x"></i></button>
                </div>
            </div>

            <!-- Modal Body -->
            <div class="flex-1 overflow-y-auto custom-scroll flex flex-col lg:flex-row">
                <!-- Left: Visual & Specs -->
                <div class="lg:w-1/3 p-8 border-r border-slate-700 bg-gradient-to-b from-[#1e293b] to-[#0f172a]">
                    <div class="aspect-video bg-slate-900 rounded-2xl mb-8 flex items-center justify-center relative overflow-hidden group shadow-inner border border-slate-800">
                        <div id="m-img" class="text-9xl transition transform group-hover:scale-110 drop-shadow-2xl">ðŸš—</div>
                        <div class="absolute top-4 right-4 px-2 py-1 bg-black/60 backdrop-blur rounded text-[10px] text-white font-bold border border-white/10">CanlÄ± GÃ¶rÃ¼nÃ¼m</div>
                    </div>
                    
                    <div class="space-y-4">
                        <div class="flex justify-between items-center p-4 rounded-xl bg-slate-800/50 border border-slate-700/50">
                            <span class="text-xs text-slate-400 font-semibold uppercase">Piyasa FiyatÄ±</span>
                            <span id="m-price" class="text-2xl font-bold text-emerald-400 tracking-tight">0 TL</span>
                        </div>
                        <div class="grid grid-cols-2 gap-3">
                            <div class="p-3 rounded-xl bg-slate-800/50 border border-slate-700/30">
                                <span class="text-[10px] text-slate-500 uppercase font-bold block mb-1">Menzil (WLTP)</span>
                                <span id="m-range" class="font-mono text-lg font-bold text-white">0 km</span>
                            </div>
                            <div class="p-3 rounded-xl bg-slate-800/50 border border-slate-700/30">
                                <span class="text-[10px] text-slate-500 uppercase font-bold block mb-1">Batarya</span>
                                <span id="m-battery" class="font-mono text-lg font-bold text-white">0 kWh</span>
                            </div>
                            <div class="p-3 rounded-xl bg-slate-800/50 border border-slate-700/30">
                                <span class="text-[10px] text-slate-500 uppercase font-bold block mb-1">0-100 km/s</span>
                                <span id="m-accel" class="font-mono text-lg font-bold text-white">0s</span>
                            </div>
                            <div class="p-3 rounded-xl bg-slate-800/50 border border-slate-700/30">
                                <span class="text-[10px] text-slate-500 uppercase font-bold block mb-1">Åžarj (DC)</span>
                                <span id="m-charge" class="font-mono text-lg font-bold text-white">0 kW</span>
                            </div>
                        </div>
                    </div>

                    <div class="mt-8">
                         <div class="flex justify-between items-end mb-2">
                             <h4 class="text-xs font-bold text-slate-400 uppercase">Kalite Skoru (QA)</h4>
                             <span id="m-quality" class="text-xl font-bold text-blue-400">8.5</span>
                         </div>
                         <div class="w-full h-2 bg-slate-800 rounded-full overflow-hidden">
                             <div id="m-bar" class="h-full bg-blue-500 w-0 transition-all duration-1000 shadow-[0_0_10px_rgba(59,130,246,0.5)]"></div>
                         </div>
                    </div>
                </div>

                <!-- Right: Analysis -->
                <div class="lg:w-2/3 p-8">
                    <div class="grid grid-cols-2 gap-8 mb-8">
                        <div class="bg-emerald-500/5 p-5 rounded-2xl border border-emerald-500/10">
                            <h4 class="flex items-center gap-2 text-sm font-bold text-emerald-400 mb-4 uppercase tracking-wider"><i class="ph-fill ph-thumbs-up"></i> GÃ¼Ã§lÃ¼ YÃ¶nler</h4>
                            <ul id="m-pros" class="space-y-3 text-sm text-slate-300"></ul>
                        </div>
                        <div class="bg-red-500/5 p-5 rounded-2xl border border-red-500/10">
                            <h4 class="flex items-center gap-2 text-sm font-bold text-red-400 mb-4 uppercase tracking-wider"><i class="ph-fill ph-thumbs-down"></i> ZayÄ±f YÃ¶nler</h4>
                            <ul id="m-cons" class="space-y-3 text-sm text-slate-300"></ul>
                        </div>
                    </div>

                    <div class="glass-panel p-6 rounded-2xl mb-6 bg-slate-800/30">
                        <div class="flex justify-between items-center mb-4">
                            <h4 class="text-xs font-bold text-slate-400 uppercase">Radar Analizi</h4>
                            <span class="text-[10px] bg-slate-700 px-2 py-1 rounded text-slate-300">Segment KÄ±yaslamasÄ±</span>
                        </div>
                        <div class="h-56 w-full flex justify-center">
                            <canvas id="modalRadar"></canvas>
                        </div>
                    </div>

                    <div class="p-4 bg-blue-600/10 border-l-4 border-blue-500 rounded-r-xl flex items-start gap-4">
                        <i class="ph-fill ph-info text-blue-400 text-2xl mt-0.5"></i>
                        <div>
                            <h5 class="text-sm font-bold text-blue-100">MÃ¼hendis GÃ¶rÃ¼ÅŸÃ¼</h5>
                            <p id="m-note" class="text-sm text-slate-400 mt-1 leading-relaxed">Bu araÃ§...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </dialog>

    <!-- LOGIC ENGINE -->
    <script>
        // --- 1. GLOBAL STATE & DATA ---
        const state = {
            currency: 'TRY',
            rates: { TRY: 1, USD: 0.029, EUR: 0.027 }, // Mock rates
            garage: [],
            compare: [],
            charts: {} // Store chart instances
        };

        const db = [
            { id: 't10x', brand: 'Togg', model: 'T10X V2 Long Range', type: 'SUV', price: 1450000, range: 523, battery: 88.5, accel: 7.8, charge: 180, quality: 7.8, scores: [8,7,9,8,7], pros: ['Yerli Ãœretim Ekosistemi', 'SÄ±nÄ±f Lideri Arka Diz Mesafesi', 'UÃ§tan Uca Dijital Kokpit'], cons: ['YazÄ±lÄ±m GÃ¼ncelleme SÄ±klÄ±ÄŸÄ±', 'Bagaj EÅŸiÄŸi YÃ¼ksek'], note: 'Fiyat/Performans dengesinde D-SUV segmentinin en mantÄ±klÄ± tercihi. Ã–zellikle yerli ÅŸarj aÄŸÄ± avantajÄ± ve vergi teÅŸvikleriyle Ã¶ne Ã§Ä±kÄ±yor.', img: 'ðŸ‡¹ðŸ‡·' },
            { id: 'mody', brand: 'Tesla', model: 'Model Y Long Range', type: 'SUV', price: 2850000, range: 533, battery: 75, accel: 5.0, charge: 250, quality: 8.5, scores: [9,10,7,10,6], pros: ['Supercharger AÄŸÄ±', 'Otopilot Teknolojisi', 'OTA GÃ¼ncellemeleri'], cons: ['Sert SÃ¼spansiyon Konforu', 'Park SensÃ¶rÃ¼ Yok (Vision)'], note: 'Teknoloji lideri. YazÄ±lÄ±m ve ÅŸarj altyapÄ±sÄ± sayesinde uzun yolculuklarda rakipsiz bir deneyim sunuyor.', img: 'ðŸ‡ºðŸ‡¸' },
            { id: 'zoe50', brand: 'Renault', model: 'Zoe ZE50', type: 'HB', price: 950000, range: 395, battery: 52, accel: 9.5, charge: 50, quality: 8.2, scores: [7,5,7,6,9], pros: ['MÃ¼kemmel Åžehir Ä°Ã§i Menzil', '22kW AC Åžarj (Ã‡ok HÄ±zlÄ±)', 'IsÄ± PompasÄ± Standart'], cons: ['YavaÅŸ DC Åžarj (50kW)', 'Eski Platform'], note: 'BÃ¼tÃ§e dostu, kendini kanÄ±tlamÄ±ÅŸ bir ÅŸehir efsanesi. Ã–zellikle 22kW AC ÅŸarj desteÄŸi ile AVM ve ofislerde Ã§ok hÄ±zlÄ± doluyor.', img: 'ðŸ‡«ðŸ‡·' },
            { id: 'mg4', brand: 'MG', model: 'MG4 Luxury', type: 'HB', price: 1390000, range: 435, battery: 64, accel: 7.9, charge: 135, quality: 8.0, scores: [8,8,7,7,8], pros: ['Arkadan Ä°tiÅŸ SÃ¼rÃ¼ÅŸ Keyfi', '50:50 AÄŸÄ±rlÄ±k DaÄŸÄ±lÄ±mÄ±', 'HÄ±zlÄ± Åžarj EÄŸrisi'], cons: ['Multimedya ArayÃ¼z HÄ±zÄ±', 'Ä°Ã§ Mekan Malzeme Kalitesi'], note: 'SÃ¼rÃ¼ÅŸ dinamiklerine Ã¶nem veren kullanÄ±cÄ±lar iÃ§in sÄ±nÄ±fÄ±nÄ±n en iyi ÅŸasi dengesine sahip model.', img: 'ðŸ‡¬ðŸ‡§' },
            { id: 'taycan', brand: 'Porsche', model: 'Taycan 4S', type: 'Sedan', price: 6500000, range: 450, battery: 93.4, accel: 4.0, charge: 270, quality: 9.8, scores: [8,10,9,9,3], pros: ['MÃ¼hendislik HarikasÄ± Åžasi', '800V Mimarisi', 'Malzeme Kalitesi'], cons: ['YÃ¼ksek Fiyat', 'Arka YaÅŸam AlanÄ±'], note: 'Elektrikli araÃ§larÄ±n sÃ¼rÃ¼ÅŸ dinamiÄŸi konusunda referans noktasÄ±. Bir spor otomobilin tÃ¼m genlerini taÅŸÄ±yor.', img: 'ðŸ‡©ðŸ‡ª' },
            { id: 'spring', brand: 'Dacia', model: 'Spring Extreme', type: 'SUV', price: 850000, range: 220, battery: 27, accel: 13.7, charge: 30, quality: 6.0, scores: [4,3,5,4,9], pros: ['En UlaÅŸÄ±labilir Fiyat', 'Kompakt Boyutlar'], cons: ['DÃ¼ÅŸÃ¼k GÃ¼venlik PuanÄ±', 'Performans Yetersiz'], note: 'Sadece ÅŸehir iÃ§i kÄ±sa mesafeler ve ikinci araÃ§ olarak dÃ¼ÅŸÃ¼nÃ¼lmeli. Otoyol kullanÄ±mÄ± iÃ§in uygun deÄŸil.', img: 'ðŸ‡·ðŸ‡´' }
        ];

        let currentModalCarId = null;

        // --- 2. FORMATTERS & UTILS ---
        function formatPrice(val) {
            const rate = state.rates[state.currency];
            const converted = val * rate;
            
            if (state.currency === 'TRY') return (converted/1000000).toFixed(2) + 'M â‚º';
            if (state.currency === 'USD') return '$' + (converted/1000).toFixed(1) + 'k';
            return 'â‚¬' + (converted/1000).toFixed(1) + 'k';
        }

        function setCurrency(curr) {
            state.currency = curr;
            // Update buttons
            ['TRY', 'USD', 'EUR'].forEach(c => {
                const btn = document.getElementById('curr-'+c);
                if(c === curr) {
                    btn.className = "px-3 py-1 rounded-md text-xs font-bold bg-blue-600 text-white shadow transition";
                } else {
                    btn.className = "px-3 py-1 rounded-md text-xs font-bold text-slate-400 hover:text-white transition";
                }
            });
            // Re-render current view
            const activeNav = document.querySelector('.nav-item.active').id.replace('nav-', '');
            router(activeNav);
        }

        // --- 3. ROUTER ---
        function router(moduleId) {
            // UI Update
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            document.getElementById('nav-' + moduleId).classList.add('active');
            
            // Title Update
            const titles = {
                dashboard: 'Analiz Kokpiti', market: 'Market Matrisi', ai: 'Nexus AI AsistanÄ±', 
                lab: 'MÃ¼hendislik Lab', compare: 'KÄ±yaslama Motoru', finance: 'Finans Merkezi',
                trends: 'Pazar Trendleri', garage: 'Sanal Garaj', reports: 'Raporlama Merkezi'
            };
            document.getElementById('page-title').innerText = titles[moduleId];

            // Render
            const container = document.getElementById('content-area');
            container.innerHTML = ''; // Clear
            container.className = "flex-1 overflow-y-auto custom-scroll p-8 relative bg-gradient-to-br from-[#1e293b] to-[#0f172a]"; // Reset classes

            switch(moduleId) {
                case 'dashboard': renderDashboard(container); break;
                case 'market': renderMarket(container); break;
                case 'ai': renderAI(container); break;
                case 'lab': renderLab(container); break;
                case 'compare': renderCompare(container); break;
                case 'finance': renderFinance(container); break;
                case 'garage': renderGarage(container); break;
                case 'reports': renderReports(container); break;
                case 'trends': renderTrends(container); break;
            }
        }

        // --- 4. MODULE RENDERERS ---

        function renderDashboard(c) {
            c.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8 animate-fade-in">
                    <!-- KPI 1 -->
                    <div class="glass-panel p-6 rounded-2xl relative overflow-hidden group">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-xs font-bold text-slate-400 uppercase tracking-wider">Pazar Hacmi</p>
                                <h3 class="text-3xl font-bold text-white mt-2">72.4k</h3>
                            </div>
                            <div class="p-2 bg-emerald-500/10 rounded-lg text-emerald-400"><i class="ph-bold ph-trend-up text-xl"></i></div>
                        </div>
                        <p class="text-xs text-emerald-400 font-bold mt-4 flex items-center gap-1">+%18.4 <span class="text-slate-500 font-normal">GeÃ§en aya gÃ¶re</span></p>
                    </div>
                    <!-- KPI 2 -->
                    <div class="glass-panel p-6 rounded-2xl relative overflow-hidden group">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-xs font-bold text-slate-400 uppercase tracking-wider">Favori Model</p>
                                <h3 class="text-2xl font-bold text-white mt-2 truncate">Togg T10X</h3>
                            </div>
                            <div class="p-2 bg-blue-500/10 rounded-lg text-blue-400"><i class="ph-bold ph-fire text-xl"></i></div>
                        </div>
                        <p class="text-xs text-blue-400 font-bold mt-4">1.2M+ <span class="text-slate-500 font-normal">GÃ¶rÃ¼ntÃ¼leme</span></p>
                    </div>
                    <!-- KPI 3 -->
                    <div class="glass-panel p-6 rounded-2xl relative overflow-hidden group">
                         <div class="flex justify-between items-start">
                            <div>
                                <p class="text-xs font-bold text-slate-400 uppercase tracking-wider">Ortalama ROI</p>
                                <h3 class="text-3xl font-bold text-white mt-2">3.5 YÄ±l</h3>
                            </div>
                            <div class="p-2 bg-purple-500/10 rounded-lg text-purple-400"><i class="ph-bold ph-timer text-xl"></i></div>
                        </div>
                        <p class="text-xs text-slate-500 mt-4 font-normal">Amortisman sÃ¼resi</p>
                    </div>
                    <!-- CTA -->
                    <div class="glass-panel p-6 rounded-2xl relative overflow-hidden group cursor-pointer border border-blue-500/30 hover:bg-blue-600/10 transition" onclick="router('ai')">
                        <div class="absolute -right-4 -bottom-4 text-8xl text-blue-500/10 group-hover:scale-110 transition"><i class="ph-fill ph-sparkle"></i></div>
                        <p class="text-xs font-bold text-blue-400 uppercase tracking-wider">HÄ±zlÄ± BaÅŸlangÄ±Ã§</p>
                        <h3 class="text-xl font-bold text-white mt-2">Nexus AI Asistan</h3>
                        <p class="text-xs text-slate-400 mt-4 group-hover:text-white transition">SihirbazÄ± BaÅŸlat &rarr;</p>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 h-96 animate-fade-in">
                    <div class="lg:col-span-2 glass-panel p-6 rounded-2xl flex flex-col">
                        <h3 class="font-bold text-white mb-6 flex items-center gap-2"><i class="ph-fill ph-chart-line-up text-blue-500"></i> SatÄ±ÅŸ Trendleri (2025)</h3>
                        <div class="flex-1 w-full relative">
                            <canvas id="dashChart"></canvas>
                        </div>
                    </div>
                    <div class="glass-panel p-6 rounded-2xl flex flex-col">
                        <h3 class="font-bold text-white mb-6 flex items-center gap-2"><i class="ph-fill ph-chart-pie-slice text-emerald-500"></i> Pazar DaÄŸÄ±lÄ±mÄ±</h3>
                        <div class="flex-1 w-full relative flex items-center justify-center">
                            <canvas id="pieChart"></canvas>
                        </div>
                    </div>
                </div>
            `;
            
            // Charts
            setTimeout(() => {
                const ctx1 = document.getElementById('dashChart');
                const ctx2 = document.getElementById('pieChart');
                
                if(ctx1) {
                    new Chart(ctx1, {
                        type: 'line',
                        data: {
                            labels: ['Oca', 'Åžub', 'Mar', 'Nis', 'May', 'Haz'],
                            datasets: [{ label: 'SatÄ±ÅŸ', data: [4500, 5200, 4800, 6100, 7500, 8200], borderColor: '#3b82f6', tension: 0.4, fill: true, backgroundColor: 'rgba(59, 130, 246, 0.1)' }]
                        },
                        options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { grid: { display: false }, ticks: { color: '#94a3b8' } }, y: { grid: { color: '#334155' }, ticks: { color: '#94a3b8' } } } }
                    });
                }
                if(ctx2) {
                    new Chart(ctx2, {
                        type: 'doughnut',
                        data: { labels: ['C-SUV', 'B-HB', 'Sedan', 'DiÄŸer'], datasets: [{ data: [45, 25, 15, 15], backgroundColor: ['#3b82f6', '#10b981', '#f59e0b', '#64748b'], borderWidth: 0 }] },
                        options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom', labels: { color: '#94a3b8', padding: 20 } } } }
                    });
                }
            }, 100);
        }

        function renderMarket(c) {
            let html = `<div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 animate-fade-in pb-10">`;
            db.forEach(car => {
                html += `
                    <div class="glass-panel rounded-2xl p-6 group relative overflow-hidden transition hover:-translate-y-1 hover:shadow-2xl hover:shadow-blue-900/20">
                        <div class="absolute top-0 right-0 p-4 opacity-5 group-hover:opacity-100 transition duration-500 text-7xl select-none grayscale group-hover:grayscale-0">${car.img}</div>
                        
                        <div class="relative z-10">
                            <div class="flex justify-between items-start mb-4">
                                <div>
                                    <span class="text-[10px] font-bold text-slate-500 uppercase tracking-wider">${car.brand}</span>
                                    <h3 class="text-xl font-bold text-white leading-tight truncate pr-2">${car.model}</h3>
                                </div>
                            </div>
                            
                            <div class="inline-block px-3 py-1 rounded-lg bg-slate-800 border border-slate-700 mb-6">
                                <span class="text-lg font-bold text-emerald-400">${formatPrice(car.price)}</span>
                            </div>

                            <div class="grid grid-cols-2 gap-3 mb-6">
                                <div class="bg-slate-900/50 p-2.5 rounded-lg border border-slate-700/50">
                                    <div class="text-[10px] text-slate-500 uppercase font-bold">Menzil</div>
                                    <div class="text-sm font-bold text-white flex items-center gap-1.5"><i class="ph-fill ph-road-horizon text-slate-400"></i> ${car.range} km</div>
                                </div>
                                <div class="bg-slate-900/50 p-2.5 rounded-lg border border-slate-700/50">
                                    <div class="text-[10px] text-slate-500 uppercase font-bold">Kalite</div>
                                    <div class="text-sm font-bold text-white flex items-center gap-1.5"><i class="ph-fill ph-star text-yellow-500"></i> ${car.quality}/10</div>
                                </div>
                            </div>

                            <div class="flex gap-3">
                                <button onclick="openModal('${car.id}')" class="flex-1 py-2.5 rounded-xl bg-blue-600 hover:bg-blue-500 text-white text-xs font-bold transition shadow-lg shadow-blue-600/20">DetaylÄ± Ä°ncele</button>
                                <button onclick="toggleCompare('${car.id}')" class="px-3 rounded-xl bg-slate-800 hover:bg-slate-700 text-slate-300 hover:text-white transition border border-slate-700"><i class="ph-bold ph-scales text-lg"></i></button>
                            </div>
                        </div>
                    </div>
                `;
            });
            html += `</div>`;
            c.innerHTML = html;
        }

        function renderAI(c) {
            c.innerHTML = `
                <div class="max-w-3xl mx-auto mt-8 text-center animate-fade-in">
                    <div class="w-24 h-24 mx-auto bg-gradient-to-tr from-purple-600 to-pink-600 rounded-3xl flex items-center justify-center shadow-[0_0_60px_rgba(168,85,247,0.3)] mb-8 animate-pulse">
                        <i class="ph-fill ph-sparkle text-5xl text-white"></i>
                    </div>
                    <h2 class="text-4xl font-bold text-white mb-4 tracking-tight">Nexus AI Asistan</h2>
                    <p class="text-lg text-slate-400 mb-10 max-w-xl mx-auto leading-relaxed">Veri odaklÄ± karar motorumuz, binlerce parametreyi analiz ederek yaÅŸam tarzÄ±nÄ±za en uygun aracÄ± %98 doÄŸrulukla bulur.</p>
                    
                    <div class="glass-panel p-10 rounded-3xl text-left border border-slate-700/50 shadow-2xl">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                            <div>
                                <label class="block text-xs font-bold text-slate-500 uppercase mb-3">Maksimum BÃ¼tÃ§e</label>
                                <div class="bg-slate-900/50 p-4 rounded-xl border border-slate-700">
                                    <input type="range" class="w-full mb-2 accent-purple-500 h-1 bg-slate-700 rounded-lg appearance-none cursor-pointer" min="500000" max="5000000" step="100000" oninput="document.getElementById('ai-val').innerText = formatPrice(this.value)">
                                    <div class="text-right text-purple-400 font-mono font-bold text-lg" id="ai-val">${formatPrice(1500000)}</div>
                                </div>
                            </div>
                            <div>
                                <label class="block text-xs font-bold text-slate-500 uppercase mb-3">KullanÄ±m AmacÄ±</label>
                                <select class="w-full bg-slate-900/50 text-white p-4 rounded-xl border border-slate-700 focus:border-purple-500 outline-none font-bold">
                                    <option>Åžehir Ä°Ã§i (GÃ¼nlÃ¼k)</option>
                                    <option>Aile & Uzun Yol</option>
                                    <option>Performans & Spor</option>
                                    <option>Ticari KullanÄ±m</option>
                                </select>
                            </div>
                        </div>

                        <button onclick="simulateAI()" class="w-full py-4 rounded-xl bg-white text-slate-900 font-bold text-lg hover:scale-[1.01] transition shadow-xl shadow-purple-500/10 flex items-center justify-center gap-3">
                            <i class="ph-bold ph-lightning"></i> Analizi BaÅŸlat
                        </button>
                    </div>
                    <div id="ai-result-area" class="mt-8 hidden"></div>
                </div>
            `;
        }

        // Module Placeholders
        function renderLab(c) { c.innerHTML = '<div class="glass-panel p-12 text-center rounded-2xl"><i class="ph-duotone ph-flask text-6xl text-slate-600 mb-4"></i><h2 class="text-2xl font-bold text-white">MÃ¼hendislik LaboratuvarÄ±</h2><p class="text-slate-400 mt-2">Batarya SoH ve Åžarj EÄŸrileri SimÃ¼lasyon ModÃ¼lÃ¼</p></div>'; }
        function renderCompare(c) { c.innerHTML = '<div class="glass-panel p-12 text-center rounded-2xl"><i class="ph-duotone ph-scales text-6xl text-slate-600 mb-4"></i><h2 class="text-2xl font-bold text-white">KÄ±yaslama Motoru</h2><p class="text-slate-400 mt-2">SeÃ§ili araÃ§larÄ± yan yana getirin.</p></div>'; }
        function renderFinance(c) { c.innerHTML = '<div class="glass-panel p-12 text-center rounded-2xl"><i class="ph-duotone ph-currency-dollar text-6xl text-slate-600 mb-4"></i><h2 class="text-2xl font-bold text-white">Finans Merkezi</h2><p class="text-slate-400 mt-2">Kredi ve TCO HesaplamalarÄ±</p></div>'; }
        function renderTrends(c) { c.innerHTML = '<div class="glass-panel p-12 text-center rounded-2xl"><i class="ph-duotone ph-chart-line-up text-6xl text-slate-600 mb-4"></i><h2 class="text-2xl font-bold text-white">Trend Analizi</h2><p class="text-slate-400 mt-2">Global lityum fiyatlarÄ± ve 2. el endeksi.</p></div>'; }
        
        function renderGarage(c) { 
            if(state.garage.length === 0) {
                c.innerHTML = '<div class="glass-panel p-12 text-center rounded-2xl"><i class="ph-duotone ph-garage text-6xl text-slate-600 mb-4"></i><h2 class="text-2xl font-bold text-white">GarajÄ±nÄ±z BoÅŸ</h2><p class="text-slate-400 mt-2">BeÄŸendiÄŸiniz araÃ§larÄ± buraya ekleyebilirsiniz.</p></div>';
            } else {
                c.innerHTML = `<div class="text-white">GarajÄ±nÄ±zda ${state.garage.length} araÃ§ var. (Liste gÃ¶rÃ¼nÃ¼mÃ¼ hazÄ±rlanÄ±yor...)</div>`;
            }
        }

        function renderReports(c) {
             c.innerHTML = `
                <div class="glass-panel p-12 text-center rounded-2xl max-w-2xl mx-auto">
                    <i class="ph-duotone ph-file-pdf text-6xl text-red-500 mb-4"></i>
                    <h2 class="text-2xl font-bold text-white">Rapor OluÅŸturucu</h2>
                    <p class="text-slate-400 mt-2 mb-8">Pazar analizi ve garajÄ±nÄ±zdaki araÃ§lar iÃ§in detaylÄ± PDF raporu hazÄ±rlayÄ±n.</p>
                    <button onclick="generateReport(this)" class="px-8 py-3 bg-blue-600 hover:bg-blue-500 text-white rounded-xl font-bold transition flex items-center gap-2 mx-auto">
                        <i class="ph-bold ph-download-simple"></i> Raporu Ä°ndir
                    </button>
                    <div id="report-status" class="mt-4 text-sm text-emerald-400 hidden"></div>
                </div>
             `;
        }

        // --- 5. INTERACTION LOGIC ---

        function simulateAI() {
            const resArea = document.getElementById('ai-result-area');
            resArea.classList.remove('hidden');
            resArea.innerHTML = `<div class="p-4 bg-purple-500/10 border border-purple-500/20 rounded-xl text-purple-300 animate-pulse">Analiz yapÄ±lÄ±yor... LÃ¼tfen bekleyin.</div>`;
            
            setTimeout(() => {
                resArea.innerHTML = `
                    <div class="glass-panel p-6 rounded-2xl border-l-4 border-purple-500 flex items-start gap-4 text-left animate-fade-in">
                        <div class="text-4xl">ðŸŽ‰</div>
                        <div>
                            <h3 class="font-bold text-white text-lg">Ã–nerilen AraÃ§: Renault Zoe ZE50</h3>
                            <p class="text-slate-400 text-sm mt-1">BÃ¼tÃ§e ve ÅŸehir iÃ§i kullanÄ±m kriterlerinize %96 uyum saÄŸladÄ±.</p>
                            <button onclick="openModal('zoe50')" class="mt-3 text-sm text-purple-400 font-bold hover:text-white transition">AracÄ± Ä°ncele &rarr;</button>
                        </div>
                    </div>
                `;
            }, 1500);
        }

        function generateReport(btn) {
            const originalText = btn.innerHTML;
            btn.innerHTML = `<i class="ph-bold ph-spinner animate-spin"></i> HazÄ±rlanÄ±yor...`;
            btn.disabled = true;
            
            setTimeout(() => {
                btn.innerHTML = originalText;
                btn.disabled = false;
                const stat = document.getElementById('report-status');
                stat.innerText = "Rapor baÅŸarÄ±yla oluÅŸturuldu! (SimÃ¼lasyon)";
                stat.classList.remove('hidden');
            }, 2000);
        }

        function openModal(id) {
            currentModalCarId = id;
            const car = db.find(c => c.id === id);
            const dialog = document.getElementById('car-modal');
            
            // Populate
            document.getElementById('m-title').innerText = car.brand + ' ' + car.model;
            document.getElementById('m-price').innerText = formatPrice(car.price);
            document.getElementById('m-range').innerText = car.range + ' km';
            document.getElementById('m-battery').innerText = car.battery + ' kWh';
            document.getElementById('m-accel').innerText = car.accel + 's';
            document.getElementById('m-charge').innerText = car.charge + ' kW';
            document.getElementById('m-quality').innerText = car.quality;
            document.getElementById('m-img').innerText = car.img;
            document.getElementById('m-note').innerText = car.note;
            
            // Garage Button State
            const gBtn = document.getElementById('m-garage-btn');
            gBtn.innerText = state.garage.includes(id) ? 'Garajdan Ã‡Ä±kar' : 'Garaja Ekle';

            // Lists
            document.getElementById('m-pros').innerHTML = car.pros.map(p => `<li class="flex gap-2.5 items-start"><div class="mt-1 min-w-[16px]"><i class="ph-fill ph-check-circle text-emerald-500"></i></div> <span>${p}</span></li>`).join('');
            document.getElementById('m-cons').innerHTML = car.cons.map(c => `<li class="flex gap-2.5 items-start"><div class="mt-1 min-w-[16px]"><i class="ph-fill ph-x-circle text-red-500"></i></div> <span>${c}</span></li>`).join('');

            // Bar
            setTimeout(() => { document.getElementById('m-bar').style.width = (car.quality * 10) + '%'; }, 300);

            // Chart
            const ctx = document.getElementById('modalRadar').getContext('2d');
            if(state.charts.modal) state.charts.modal.destroy();
            
            state.charts.modal = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['Menzil', 'Performans', 'Konfor', 'Teknoloji', 'Fiyat'],
                    datasets: [{
                        label: 'Skor',
                        data: car.scores,
                        backgroundColor: 'rgba(59, 130, 246, 0.2)',
                        borderColor: '#3b82f6',
                        pointBackgroundColor: '#3b82f6',
                        pointBorderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    scales: { r: { min: 0, max: 10, ticks: { display: false, backdropColor: 'transparent' }, grid: { color: '#334155' }, pointLabels: { color: '#94a3b8', font: { size: 10, weight: 'bold' } } } },
                    plugins: { legend: { display: false } }
                }
            });

            dialog.showModal();
        }

        function closeModal() {
            document.getElementById('car-modal').close();
        }

        function toggleGarage(id) {
            if(!id) return;
            const idx = state.garage.indexOf(id);
            if(idx > -1) {
                state.garage.splice(idx, 1);
            } else {
                state.garage.push(id);
            }
            
            // Update UI
            const badge = document.getElementById('garage-badge');
            badge.innerText = state.garage.length;
            badge.classList.toggle('hidden', state.garage.length === 0);
            
            // Update Modal Button if open
            if(document.getElementById('car-modal').open) {
                document.getElementById('m-garage-btn').innerText = state.garage.includes(id) ? 'Garajdan Ã‡Ä±kar' : 'Garaja Ekle';
            }
        }

        function toggleCompare(id) {
            const idx = state.compare.indexOf(id);
            if(idx > -1) {
                state.compare.splice(idx, 1);
            } else {
                if(state.compare.length >= 3) return alert('En fazla 3 araÃ§ kÄ±yaslanabilir.');
                state.compare.push(id);
            }
            const badge = document.getElementById('compare-badge');
            badge.innerText = state.compare.length;
            badge.classList.toggle('hidden', state.compare.length === 0);
        }

        // Init
        window.onload = function() {
            const d = new Date();
            document.getElementById('current-date').innerText = d.toLocaleDateString('tr-TR', { day: 'numeric', month: 'long', year: 'numeric' });
            router('dashboard');
        };

    </script>
</body>
</html>